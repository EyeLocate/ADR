# ADR — Выбор технологий для ML-модуля системы видеомониторинга

## Контекст

ML-модуль системы отвечает за:

* детекцию объектов и лиц на кадрах с камер;
* распознавание личности обнаруженных лиц;
* передачу результатов на бэкенд для последующей обработки и хранения.

Основные требования:

* высокая точность и скорость детекции и распознавания;
* возможность интеграции с другими модулями системы;
* зрелость и поддержка библиотек.

## Сравнение технологий для детекции объектов (YOLO и конкуренты)

| Модель        | Скорость (FPS) | Точность      | Простота интеграции | Примечания                                                                                                             |
| ------------- | -------------- | ------------- | ------------------- | ---------------------------------------------------------------------------------------------------------------------- |
| YOLO (выбран) | Очень высокая  | Высокая       | Высокая             | Оптимальное соотношение скорость/точность для real-time детекции, широко используется в промышленности и исследованиях |
| SSD           | Высокая        | Средняя       | Средняя             | Быстрее Faster R-CNN, но уступает YOLO по точности и зрелости интеграции                                               |
| Faster R-CNN  | Средняя        | Очень высокая | Средняя             | Высокая точность, но медленная и сложная интеграция для real-time сценариев                                            |
| DETR/RT-DETR  | Высокая        | Очень высокая | Средняя             | Современные трансформерные модели, требуют GPU и настройки, сложнее интегрировать                                      |

## Сравнение технологий для распознавания лиц (face_recognition и конкуренты)

| Библиотека                 | Точность      | Простота интеграции | Масштабируемость | Примечания                                                                            |
| -------------------------- | ------------- | ------------------- | ---------------- | ------------------------------------------------------------------------------------- |
| face_recognition (выбран)  | Высокая       | Очень высокая       | Средняя          | Быстрая интеграция, зрелая библиотека, достаточная точность для продакшн-сценариев    |
| DeepFace (FaceNet/ArcFace) | Очень высокая | Средняя             | Высокая          | Более точная, требует настройки и обучения моделей, сложнее интеграция в текущий стек |
| InsightFace                | Очень высокая | Средняя             | Высокая          | Высокая точность, поддержка мульти-GPU, требует тонкой настройки и обучения           |
| VIPLFaceNet                | Высокая       | Средняя             | Средняя          | Хорошая точность, ограниченная поддержка и документация, менее распространена         |

## Обоснование выбора

* **YOLO:** Обеспечивает оптимальный баланс скорости и точности для детекции лиц в реальном времени, легко интегрируется с Python-экосистемой.
* **face_recognition:** Позволяет быстро реализовать функционал распознавания лиц с достаточной точностью, имеет зрелую документацию и активное сообщество.
* **Интеграция с системой:** Python-библиотеки легко взаимодействуют с Go-бэкендом через REST/gRPC, упрощая передачу результатов детекции и распознавания.
* **Гибкость:** При необходимости можно заменить face_recognition на более точные модели (ArcFace, InsightFace) без значительных изменений в архитектуре.

**Вывод:** Выбор YOLO и face_recognition обеспечивает быстрый запуск, достаточную точность и лёгкую интеграцию в систему, оставляя возможность для улучшения моделей в будущем.
