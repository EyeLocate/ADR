# ADR — Выбор базы данных для системы видеомониторинга

## Контекст

База данных является ключевой частью системы, предназначенной для хранения:

* информации о пользователях и ролях;
* конфигураций камер и локаций;
* логов событий и результатов детекции/распознавания лиц;
* истории действий и аудита системы.

Основные требования:

* поддержка ACID-транзакций;
* гибкость хранения структурированных и полуструктурированных данных;
* масштабируемость при увеличении числа камер и пользователей;
* надежность и высокая доступность;
* возможности аналитики и индексирования.

## Сравнение СУБД

| СУБД                | Транзакции (ACID) | Простота разработки | Масштабируемость | Зрелость экосистемы | Примечания                                                                                                                               |
| ------------------- | ----------------- | ------------------- | ---------------- | ------------------- | ---------------------------------------------------------------------------------------------------------------------------------------- |
| PostgreSQL (выбран) | Полная            | Средняя             | Высокая          | Очень высокая       | Поддержка сложных схем, JSONB, индексов, расширенные функции для аналитики, высокая надежность и гибкость                                |
| MySQL               | Частичная         | Высокая             | Средняя          | Очень высокая       | Хорошо подходит для read-heavy нагрузок, меньше возможностей для сложной аналитики и хранения полуструктурированных данных               |
| MongoDB             | Нет (NoSQL)       | Высокая             | Высокая          | Высокая             | Удобна для хранения неструктурированных данных, но нет полной транзакционной целостности, сложнее обеспечить сложные связи и ограничения |

## Обоснование выбора PostgreSQL

* **Поддержка ACID:** Обеспечивает полную транзакционную целостность данных, что критично для хранения конфигураций и логов системы.
* **Гибкость схемы:** Позволяет хранить как традиционные таблицы, так и полуструктурированные данные через JSONB, что упрощает расширение функционала без изменения всей схемы.
* **Масштабируемость:** Поддержка репликации и шардирования позволяет эффективно масштабировать систему при увеличении числа камер и пользователей.
* **Аналитика и индексы:** Расширенные возможности индексирования и аналитические функции позволяют быстро получать сводные данные и отчеты.
* **Надежность и зрелость:** Долгие годы использования в корпоративных проектах, высокая стабильность и проверенная экосистема инструментов.

**Вывод:** PostgreSQL обеспечивает оптимальное сочетание надежности, гибкости, поддержки транзакций и аналитических возможностей, что делает её лучшим выбором для хранения данных системы видеомониторинга по сравнению с MySQL и NoSQL решениями.
